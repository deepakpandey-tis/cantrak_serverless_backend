const AWS = require("aws-sdk");
const knex = require("../db/knex");
const moment = require("moment-timezone");
const chromium = require("chrome-aws-lambda");
const uuid = require("uuid/v4");
const PDFMerger = require("pdf-merger-js");
const merger = new PDFMerger();
const path = require("path");
const fs = require("fs-extra");

const redisHelper = require("../helpers/redis");

AWS.config.update({
  accessKeyId: process.env.ACCESS_KEY_ID,
  secretAccessKey: process.env.SECRET_ACCESS_KEY,
  region: process.env.REGION || "ap-southeast-1",
});

async function createQRCodeWithImage(dataForQRcode, center_image = '', width = 150, cwidth = 50) {
  const QRCODE = require("qrcode");
  const { createCanvas, loadImage } = require("canvas");
  const canvas = createCanvas(width, width);
  QRCODE.toCanvas(
    canvas,
    dataForQRcode,
    {
      errorCorrectionLevel: "H",
      margin: 1,
      color: {
        dark: "#000000",
        light: "#ffffff",
      },
    }
  );

  const ctx = canvas.getContext("2d");

  //  Image not passed, use default ie. Cantrak Logo
  const centerImage = center_image != '' ? center_image : "data:image/png;base64,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";

  // const img = await loadImage(center_image);
  const img = await loadImage(centerImage);
  const center = (width - cwidth) / 2;
  ctx.drawImage(img, center, center, cwidth, cwidth);
  return canvas.toDataURL("image/png");
}


const s3 = new AWS.S3();

const createPdfOnEFS = (
  document,
  requestId,
  browser,
  retries = 1
) => {
  return new Promise(async (res, rej) => {
    try {
      console.log(
        "Retries/ HTML To PRINT:",
        retries,
        document.html
      );

      const page = await browser.newPage();
      await page.setContent(document.html, {
        waitUntil: [
          "load",
          "domcontentloaded",
          "networkidle0",
        ],
      });

      const pdf = await page.pdf({
        path: document.s3BasePath + document.filename,
        format: "A4",
        printBackground: true,
        displayHeaderFooter: false,
        margin: {
          top: "1cm",
          right: "1cm",
          bottom: "1cm",
          left: "1cm",
        },
      });

      if (!pdf) {
        console.log("Unable to generate PDF...");
        rej(new Error("Unable to generate PDF..."));
      } else {
        console.log(
          "PDF generated, with filename:",
          document.s3BasePath + document.filename
        );
        await page.close();
        res(true);
      }
    } catch (err) {
      // rej(err);  // don't reject ... add a retry...

      if (!browser || wasBrowserKilled(browser)) {
        await chromium.font(
          "https://servicemind-resources-dev.s3.amazonaws.com/fonts/Pattaya-Regular.otf"
        );
        browser = await chromium.puppeteer.launch({
          args: chromium.args,
          defaultViewport: chromium.defaultViewport,
          executablePath: await chromium.executablePath,
          headless: chromium.headless,
        });
      }

      retries++;
      // gfx: Org line if (retries > 5) {
      // gfx: retry up to 5 times
      if (retries <= 5) {
        console.log("Retrying after error:", err);
        await createPdf(document, requestId, browser, retries);
      } else {
        rej(err);
      }
    }
  });
};

const mergedPdf = (folder, pdfFileName) => {



  console.log("[helpers][plant-qrcode][mergePdfFiles]: folder: ", folder);
  console.log("[helpers][plant-qrcode][mergePdfFiles]: pdfFileName: ", pdfFileName);
  const path = require("path");



  console.log("[helpers][plant-qrcode][mergePdfFiles]: Going to store in S3 Bucket");

  return new Promise(async (res, rej) => {

    fs.readdirSync(folder).forEach((file) => {
      console.log("[helpers][plant-qrcode][mergePdfFiles]: Found:", file);
      merger.add(path.join(folder, file));
    });


    await merger.save(`${pdfFileName}`);
    let filename = path.parse(pdfFileName);
    filename = filename.base;
    console.log("[helpers][plant-qrcode][mergePdfFiles]: Parsed File name", filename);

    const fileUrl = await uploadFileToS3(pdfFileName, filename);

    console.log('[helpers][plant-qrcode][mergePdfFiles]:File Uploaded At Url:', fileUrl);


    res({ fileUrl, fileName: filename });

  });
};

const uploadFileToS3 = async (filePath, s3Path) => {

  let bucketName = process.env.S3_BUCKET_NAME;
  return new Promise((resolve, reject) => {

    fs.readFile(filePath, (err, file_buffer) => {
      let params = {
        Bucket: bucketName,
        Key: s3Path,
        Body: file_buffer,
        ACL: "public-read",
      };

      s3.putObject(params, (err, data) => {
        if (err) {
          console.log("Error at uploadPDFFileOnS3Bucket function", err);
          reject(err);
        } else {
          let fileUrl = process.env.S3_BUCKET_URL + s3Path;
          console.log("[helpers][plant-qrcode][mergePdfFiles]: PDF File uploaded Successfully on s3...", fileUrl);
          resolve(fileUrl);
        }
      });
    });

  });

};

const makeZippedFileOnEFS = (folder, zipFileKey) => {
  const fs = require("fs-extra");
  const archiver = require("archiver");
  let bucketName = process.env.S3_BUCKET_NAME;

  console.log(
    "[helpers][plant-qrcode][makeZippedFileOnEFS]: folder: ",
    folder
  );
  console.log(
    "[helpers][plant-qrcode][makeZippedFileOnEFS]: zipFileKey: ",
    zipFileKey
  );

  console.log(
    "[helpers][plant-qrcode][makeZippedFileOnEFS]: Lisiting ALL FILES: "
  );

  fs.readdirSync(folder).forEach((file) => {
    console.log(
      "[helpers][plant-qrcode][makeZippedFileOnEFS]: Found:",
      file
    );
  });

  return new Promise(async (res, rej) => {
    const output = fs.createWriteStream(zipFileKey);
    const archive = archiver("zip");

    output.on("close", async () => {
      console.log(archive.pointer() + " total bytes");
      console.log(
        "[helpers][plant-qrcode][makeZippedFileOnEFS]: archiver has been finalized and the output file descriptor has closed."
      );

      const fileContent = fs.readFileSync(zipFileKey);
      console.log(
        "[helpers][plant-qrcode][makeZippedFileOnEFS]: Zipped File Content Read Successfully for uploading to s3.",
        fileContent
      );


      const params = {
        Bucket: bucketName,
        Key: zipFileKey,
        Body: fileContent,
        ACL: "public-read",
      };
      let s3Res = await s3.putObject(params).promise();
      console.log(
        "[helpers][plant-qrcode][makeZippedFileOnEFS]: Zip File uploaded Successfully on s3...",
        s3Res
      );

      res(true);
    });

    archive.on("error", (err) => {
      rej(err);
    });

    archive.pipe(output);

    // append files from a sub-directory, putting its contents at the root of archive
    archive.directory(folder, false);
    archive.finalize();
  });
};

const plantQRCodeHelper = {
  plantSNSNotification: async ({
    orgId,
    module,
    data,
    receiver,
  }) => {
    try {
      console.log(
        "[plant-qrcode][SNS][NOTIFICATION]",
        orgId,
        module,
        data,
        receiver
      );

      const snsHelper = require("../helpers/sns");

      const message = {
        orgId: orgId,
        module: module,
        data: {
          plantQRCodeDetail: data.plantQRCodeDetail,
        },
      };

      await snsHelper.sendSNSMessage(
        message,
        "THIRDPARTY_NOTIFICATIONS"
      );
    } catch (err) {
      return { failed: true, error: err };
    }
  },

  generatePlantQRCodeDocumentOnEFSv2: async ({
    requestId,
    data,
    orgId,
    plantQRCodeKey,
    requestedBy,
  }) => {
    let browser = null;
    let bucketName = process.env.S3_BUCKET_NAME;
    const mountPathRoot = process.env.MNT_DIR;
    const fs = require("fs-extra");
    const QRCODE = require("qrcode");
    const ejs = require("ejs");
    const path = require("path");

    const timezone = "Asia/Bangkok";
    moment.tz.setDefault(timezone);
    //const requestId = uuid();

    try {
      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: Data:",
        data
      );

      const Parallel = require("async-parallel");

      let plantData = data.plantList;
      //let orgId = data.orgId;

      const basePath =
        mountPathRoot +
        "/PLANT/" +
        requestId +
        "/PlantQRCodeListDocuments/" +
        new Date().getTime() +
        "/";
      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: Base Directory (For Docs)....",
        basePath
      );

      // First Clean all files from the base directory....
      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: Cleaning basepath directory for Plant....",
        requestId
      );
      await fs.remove(basePath);
      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: basepath Directory cleaned....",
        basePath
      );

      //Ensure that directory is created...
      await fs.ensureDir(basePath);
      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: basepath Directory Created/Ensured....",
        basePath
      );

      // Write Logic to prepare all objects for generating parallely.........
      Parallel.setConcurrency(30);
      let sheetsToPrepare = [];

      // Read HTML Template
      const templatePath = path.join(
        __dirname,
        "..",
        "pdf-templates",
        "plant-qrcode-template.ejs"
      );
      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: PDF Template Path:",
        templatePath
      );

      let pData = [];
      let pId = [];
      let index = 0;
      plantData = await Parallel.map(
        plantData,
        async (data) => {
          try {
            if (pData.length < 8) {

                let qrCodeObj = {
                    qrName: QrCodeName,
                    orgId: pData.orgId,
                    plantId: pData.id
                };
                let qrString = JSON.stringify(qrCodeObj);
                // console.log("[helpers][plant-qrcode][generatePlantQRCodeDocument]: Qr String: ", qrString);

                //  below lines commented to generate qrcode with logo
                // let qrCodeDataURI = await QRCODE.toDataURL(
                // qrString
                // );

                //  image not passed, function will use default image - Cantrak logo
                let qrCodeDataURI = await createQRCodeWithImage(
                  qrString,
                  "",
                  150,
                  50
                );

                data.qrCode = qrCodeDataURI;
                data.plantedOn = moment(
                +data.plantedOn
                ).format("d MMM yyyy");

                pData.push(data);
                pId.push(data.plantSerial);
            } else {
                pData = [];
                pId = [];

                let qrCodeObj = {
                    qrName: QrCodeName,
                    orgId: pData.orgId,
                    plantId: pData.id
                };
                let qrString = JSON.stringify(qrCodeObj);
                // console.log("[helpers][plant-qrcode][generatePlantQRCodeDocument]: Qr String: ", qrString);

                //  below lines commented to generate qrcode with logo
                // let qrCodeDataURI = await QRCODE.toDataURL(
                // qrString
                // );

                //  image not passed, function will use default image - Cantrak logo
                let qrCodeDataURI = await createQRCodeWithImage(
                  qrString,
                  "",
                  150,
                  50
                );

                data.qrCode = qrCodeDataURI;
                data.plantedOn = moment(
                +data.plantedOn
                ).format("d MMM yyyy");

                pData.push(data);
                pId.push(data.plantSerial);

            }

            if (
              pData.length == 8
            ) {
              console.log("plantData", pData);

              let htmlContents = await ejs.renderFile(
                templatePath,
                { data: pData }
              );
              console.log(
                "[helpers][plant-qrcode][generatePlantQRCodeDocument]: htmlContents:",
                htmlContents
              );

              let filename = `plant-qrcode-list-${pId.join(
                ","
              )}.pdf`;

              const document = {
                html: htmlContents,
                data: {
                  plantData: pData,
                },
                s3BasePath: basePath,
                filename: filename,
              };

              console.log(
                "[helpers][plant-qrcode][generatePlantQRCodeDocument]: Prepared Doc for Plant: ",
                document
              );
              sheetsToPrepare.push(document);
              pData = [];
              pId = [];
            } else if (!plantData[index + 1]) {
              let htmlContents = await ejs.renderFile(
                templatePath,
                { data: pData }
              );
              console.log(
                "[helpers][plant-qrcode][generatePlantQRCodeDocument]: htmlContents:",
                htmlContents
              );

              let filename = `plant-qrcode-list-${pId.join(
                ","
              )}.pdf`;

              const document = {
                html: htmlContents,
                data: {
                  plantData: pData,
                },
                s3BasePath: basePath,
                filename: filename,
              };

              console.log(
                "[helpers][plant-qrcode][generatePlantQRCodeDocument]: Prepared Doc for Plant: ",
                document
              );
              sheetsToPrepare.push(document);
              pData = [];
              pId = [];
            }

            index++;
          } catch (err) {
            console.error(
              "[helpers][plant-qrcode][generatePdf]: Inner Loop: Error",
              err
            );
            if (err.list && Array.isArray(err.list)) {
              err.list.forEach((item) => {
                console.error(
                  `[helpers][plant-qrcode][generatePdf]: Inner Loop Each Error:`,
                  item.message
                );
              });
            }
            throw new Error(err);
          }
          return data;
        }
      );

      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: Generation Finished. Going to PRiNT"
      );
      console.log(
        "============================== PRiNT ======================================"
      );

      await chromium.font(
        "https://servicemind-resources-dev.s3.amazonaws.com/fonts/Pattaya-Regular.otf"
      );
      browser = await chromium.puppeteer.launch({
        args: chromium.args,
        defaultViewport: chromium.defaultViewport,
        executablePath: await chromium.executablePath,
        headless: chromium.headless,
      });

      Parallel.setConcurrency(5);
      await Parallel.each(
        sheetsToPrepare,
        async (document) => {
          console.log(
            "[helpers][plant-qrcode][generatePlantQRCodeDocument]: Generating Doc for: ",
            document
          );
          await createPdfOnEFS(
            document,
            requestId,
            browser
          );
        }
      );

      console.log(
        "============================== PRiNT DONE ======================================"
      );

      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: All PDF documents created successfully. Going to create zip file.. "
      );

      if (browser !== null) {
        await browser.close();
        browser = null;
      }

      // Write Code to create Zip File...
      const mergePdfDir = path.join(mountPathRoot, 'PLANT', `${requestId}`, 'merged-files');
      await fs.ensureDir(mergePdfDir);
      console.log("[helpers][plant-qrcode][generatePlantQRCodeDocument]: ZipFile Directory Created/Ensured....");

      const mergedPdfName = path.join(mergePdfDir, `${new Date().getTime()}.pdf`);
      const { fileUrl, fileName } = await mergedPdf(basePath, mergedPdfName);
      console.log("[helpers][plant-qrcode][generatePlantQRCodeDocument]: merged File created successfully, Url/Name:", fileUrl, fileName);


      let s3FileDownloadUrl = await new Promise(
        (resolve, reject) => {
          s3.getSignedUrl(
            "getObject",
            {
              Bucket: bucketName,
              Key: fileName,
              Expires: 24 * 60 * 60,
            },
            (err, url) => {
              if (err) reject(err);
              else resolve(url);
            }
          );
        }
      );

      console.log("[helpers][plant-qrcode][generatePlantQRCodeDocument]: s3FileDownloadUrl:", s3FileDownloadUrl);

      let docGeneratedList = await redisHelper.getValue(plantQRCodeKey);
      if (docGeneratedList) {
        docGeneratedList.map((e) => {
          let s3Url = e.s3Url;
          if (e.requestId) {
            s3Url = s3FileDownloadUrl;
          }
          e.s3Url = s3Url;
        });

        await redisHelper.setValueWithExpiry(plantQRCodeKey, docGeneratedList, 24 * 60 * 60);
      } else {


        await redisHelper.setValueWithExpiry(plantQRCodeKey,
          [
            {
              requestId: requestId,
              generatedBy: requestedBy,
              orgId: orgId,
              s3Url: s3FileDownloadUrl,
              generatedAt: moment().format("MMMM DD, yyyy, hh:mm:ss A"),
            },
          ],
          24 * 60 * 60
        );
      }

      let sender = requestedBy;
      let receiver = requestedBy;

      let orgData = await knex("organisations")
        .where({ id: orgId })
        .first();

      let notificationPayload = {
        payload: {
          title: "Plant - Plant QRCode Document Generated",
          description: `Plant - Plant QRCode Document Generated`,
          url: `/admin/plants`,
          orgData: orgData,
        },
      };

      const plantQRCodeDocGeneratedNotification = require("../notifications/Plant/plant-qrcode-doc-generated");
      await plantQRCodeDocGeneratedNotification.send(
        sender,
        receiver,
        notificationPayload,
        ["IN_APP"]
      );
      console.log(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]: Successfull Plant List Doc Generated - Announcement Send to:",
        receiver.email
      );
    } catch (err) {
      console.error(
        "[helpers][plant-qrcode][generatePlantQRCodeDocument]:  Error",
        err
      );
      if (err.list && Array.isArray(err.list)) {
        err.list.forEach((item) => {
          console.error(
            `[helpers][plant-qrcode][generatePlantQRCodeDocument]: Each Error:`,
            item.message
          );
        });
      }
      return {
        code: "UNKNOWN_ERROR",
        message: err.message,
        error: err,
      };
    } finally {
    }
  },
};

module.exports = plantQRCodeHelper;
